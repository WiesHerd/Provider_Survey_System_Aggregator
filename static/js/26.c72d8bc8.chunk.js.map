{"version":3,"file":"static/js/26.c72d8bc8.chunk.js","mappings":"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","sources":["services/BackendService.ts","components/DataPreview.tsx","components/SurveyUpload.tsx"],"sourcesContent":["import { \n  ISurveyData, \n  ISurveyRow \n} from '../types/survey';\n\nconst API_BASE_URL = 'https://survey-aggregator-backend.azurewebsites.net/api';\n\nclass BackendService {\n  private static instance: BackendService;\n\n  private constructor() {}\n\n  public static getInstance(): BackendService {\n    if (!BackendService.instance) {\n      BackendService.instance = new BackendService();\n    }\n    return BackendService.instance;\n  }\n\n  // Get survey metadata (includes original columns list)\n  public async getSurveyMeta(surveyId: string): Promise<{ columns?: string[] }> {\n    const response = await fetch(`${API_BASE_URL}/survey/${surveyId}/meta`);\n    if (!response.ok) throw new Error('Failed to fetch survey metadata');\n    return await response.json();\n  }\n\n  // Upload a survey file\n  public async uploadSurvey(\n    file: File,\n    surveyName: string,\n    surveyYear: number,\n    surveyType: string,\n    onProgress?: (percent: number) => void\n  ): Promise<{ surveyId: string; rowCount: number }> {\n    const formData = new FormData();\n    formData.append('file', file);\n    formData.append('name', surveyName);\n    formData.append('year', surveyYear.toString());\n    formData.append('type', surveyType);\n\n    // Use XHR to report real upload progress\n    const xhr = new XMLHttpRequest();\n    const promise = new Promise<{ surveyId: string; rowCount: number }>((resolve, reject) => {\n      xhr.open('POST', `${API_BASE_URL}/upload`);\n      xhr.onload = () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          try {\n            const result = JSON.parse(xhr.responseText);\n            resolve({ surveyId: result.surveyId, rowCount: result.rowCount });\n          } catch (err) {\n            reject(new Error('Invalid server response'));\n          }\n        } else {\n          reject(new Error(`Upload failed: ${xhr.status} ${xhr.statusText}`));\n        }\n      };\n      xhr.onerror = () => reject(new Error('Network error during upload'));\n      xhr.upload.onprogress = (event) => {\n        if (!onProgress || !event.lengthComputable) return;\n        const percent = Math.round((event.loaded / event.total) * 100);\n        onProgress(percent);\n      };\n      xhr.send(formData);\n    });\n\n    return promise;\n  }\n\n  // Get all surveys\n  public async getAllSurveys(): Promise<ISurveyData[]> {\n    const response = await fetch(`${API_BASE_URL}/surveys`);\n    \n    if (!response.ok) {\n      throw new Error('Failed to fetch surveys');\n    }\n\n    const surveys = await response.json();\n    \n    // Transform backend format to frontend format\n    return surveys.map((survey: any) => ({\n      id: survey.id,\n      name: survey.name,\n      year: survey.year.toString(),\n      type: survey.type,\n      uploadDate: survey.uploadDate,\n      rowCount: survey.rowCount ?? survey.row_count ?? 0,\n      specialtyCount: survey.specialtyCount ?? survey.specialty_count ?? 0,\n      dataPoints: survey.dataPoints ?? survey.data_points ?? 0,\n      colorAccent: survey.colorAccent || '#6366F1',\n      metadata: survey.metadata\n    }));\n  }\n\n  // Get survey data with filters\n  // CRITICAL: Always pass options.limit for large datasets to avoid missing data\n  // See docs/ALLERGY_IMMUNOLOGY_FIX.md for details on the 100-row default limit issue\n  public async getSurveyData(\n    surveyId: string,\n    filters?: {\n      specialty?: string;\n      providerType?: string;\n      region?: string;\n    },\n    options?: { page?: number; limit?: number }\n  ): Promise<{ rows: ISurveyRow[]; pagination?: { page: number; limit: number; total: number; pages: number } }>{\n    const params = new URLSearchParams();\n    if (filters?.specialty) params.append('specialty', filters.specialty);\n    if (filters?.providerType) params.append('providerType', filters.providerType);\n    if (filters?.region) params.append('region', filters.region);\n    if (options?.page) params.append('page', String(options.page));\n    if (options?.limit) params.append('limit', String(options.limit));\n\n    const response = await fetch(`${API_BASE_URL}/survey/${surveyId}/data?${params.toString()}`);\n    \n    if (!response.ok) {\n      throw new Error('Failed to fetch survey data');\n    }\n\n    const data = await response.json();\n    \n    // Transform backend format to frontend format\n    // Backend returns { data: [...], pagination: {...} }\n    const surveyData = data.data || data;\n    // Keep all keys so the grid can render every original column.\n    const rows = surveyData.map((row: any) => ({ ...row }));\n    const pagination = data.pagination\n      ? {\n          page: Number(data.pagination.page) || 1,\n          limit: Number(data.pagination.limit) || rows.length,\n          total: Number(data.pagination.total) || rows.length,\n          pages: Number(data.pagination.pages) || 1,\n        }\n      : undefined;\n    return { rows, pagination };\n  }\n\n  // Get available filters\n  public async getAvailableFiltersForSurvey(surveyId: string): Promise<{\n    specialties: string[];\n    providerTypes: string[];\n    regions: string[];\n  }> {\n    const response = await fetch(`${API_BASE_URL}/survey/${surveyId}/filters`);\n    \n    if (!response.ok) {\n      throw new Error('Failed to fetch filters');\n    }\n\n    return await response.json();\n  }\n\n  // Delete a survey\n  public async deleteSurvey(surveyId: string): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}/survey/${surveyId}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to delete survey');\n    }\n  }\n\n  // Delete all surveys\n  public async deleteAllSurveys(): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}/surveys`, { method: 'DELETE' });\n    if (!response.ok) throw new Error('Failed to delete all surveys');\n  }\n\n  // Export survey data\n  public async exportSurveyData(\n    surveyId: string,\n    format: 'csv' | 'json' = 'csv'\n  ): Promise<Blob> {\n    const response = await fetch(`${API_BASE_URL}/survey/${surveyId}/export?format=${format}`);\n    \n    if (!response.ok) {\n      throw new Error('Failed to export survey data');\n    }\n\n    return await response.blob();\n  }\n\n  // Health check\n  public async healthCheck(): Promise<boolean> {\n    try {\n      const response = await fetch(`${API_BASE_URL}/health`);\n      return response.ok;\n    } catch {\n      return false;\n    }\n  }\n}\n\nexport default BackendService;\n","import React, { useState, useEffect, useMemo, Suspense, lazy } from 'react';\nimport {\n  FormControl,\n  InputLabel,\n  MenuItem,\n  Select,\n  Box\n} from '@mui/material';\nimport BackendService from '../services/BackendService';\n\n// Lazy load AG Grid to reduce initial bundle size\nconst AgGridWrapper = lazy(() => import('./AgGridWrapper'));\n\n// Loading component for AG Grid\nconst AgGridLoadingSpinner = () => (\n  <div className=\"flex items-center justify-center h-64\">\n    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600\"></div>\n    <span className=\"ml-2 text-gray-600\">Loading data table...</span>\n  </div>\n);\n\n// Custom header component for pinning columns\nconst CustomHeader = (props: any) => {\n  const { displayName, onPinColumn, colId, isSpecialty, isNumeric } = props;\n  const [isPinned, setIsPinned] = useState(false);\n  \n  const handlePinClick = () => {\n    setIsPinned(!isPinned);\n    onPinColumn(colId);\n  };\n\n  return (\n    <div className={`flex items-center w-full ${isNumeric ? 'justify-end' : 'justify-between'}`}>\n      <span className={`truncate ${isSpecialty ? 'font-semibold' : ''} ${isNumeric ? 'text-right' : ''}`}>{displayName}</span>\n      <button\n        onClick={handlePinClick}\n        className={`ml-2 p-1 rounded hover:bg-gray-100 transition-colors ${\n          isPinned ? 'text-indigo-600' : 'text-gray-400'\n        }`}\n        title={isPinned ? 'Unfreeze column' : 'Freeze column'}\n      >\n        {isPinned ? (\n          <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fillRule=\"evenodd\" d=\"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clipRule=\"evenodd\" />\n          </svg>\n        ) : (\n          <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path d=\"M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z\" />\n          </svg>\n        )}\n      </button>\n    </div>\n  );\n};\n\ninterface DataPreviewProps {\n  file: {\n    id: string;\n    fileName: string;\n    surveyType: string;\n    surveyYear: string;\n    uploadDate: Date;\n    fileContent?: string;\n  };\n  onError: (message: string) => void;\n  globalFilters: {\n    specialty: string;\n    providerType: string;\n    region: string;\n  };\n  onFilterChange: (filterName: string, value: string) => void;\n}\n\ninterface FileStats {\n  columnNames: string[];\n  totalRows: number;\n  uniqueSpecialties: number;\n  totalDataPoints: number;\n}\n\nconst DataPreview: React.FC<DataPreviewProps> = ({ file, onError, globalFilters, onFilterChange }) => {\n  const [previewData, setPreviewData] = useState<string[][]>([]);\n  const [originalData, setOriginalData] = useState<any[]>([]);\n  const [stats, setStats] = useState<FileStats | null>(null);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize] = useState(100);\n  const [pagination, setPagination] = useState<{ page: number; limit: number; total: number; pages: number } | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const rowsPerPage = 10;\n  const [gridApi, setGridApi] = useState<any | null>(null);\n  const [columnApi, setColumnApi] = useState<any | null>(null);\n  // Removed table-level quick search to rely on existing dropdown filters\n  const selectableHeaders = useMemo(() => (previewData[0] || []) as string[], [previewData]);\n  const [pinColumnId, setPinColumnId] = useState<string>('');\n\n  const [serverSpecialties, setServerSpecialties] = useState<string[]>([]);\n  const [serverProviderTypes, setServerProviderTypes] = useState<string[]>([]);\n  const [serverRegions, setServerRegions] = useState<string[]>([]);\n\n  const handleFilterChange = (\n    event: React.ChangeEvent<{ name?: string; value: unknown }> | any\n  ) => {\n    onFilterChange(event.target.name, event.target.value);\n  };\n\n  useEffect(() => {\n    let isCancelled = false;\n    const loadSurveyData = async () => {\n      try {\n        // Only show loading on initial load or page change, not filter changes\n        if (currentPage === 1 && !originalData.length) {\n          setIsLoading(true);\n        }\n        \n        const backendService = BackendService.getInstance();\n        \n        // Pass current filters to server for server-side filtering\n        const filters = {\n          specialty: globalFilters.specialty || undefined,\n          providerType: globalFilters.providerType || undefined,\n          region: globalFilters.region || undefined\n        };\n        \n        const { rows: surveyData, pagination } = await backendService.getSurveyData(\n          file.id,\n          filters,\n          { page: currentPage, limit: pageSize }\n        );\n        \n        if (!isCancelled && surveyData.length > 0) {\n          // Store original data for filtering\n          setOriginalData(surveyData);\n          \n          // Prefer original CSV header order from survey metadata if available\n          let headers: string[] = [];\n          try {\n            const meta = await BackendService.getInstance().getSurveyMeta(file.id);\n            if (Array.isArray(meta.columns) && meta.columns.length > 0) {\n              headers = meta.columns;\n            } else {\n              headers = Object.keys(surveyData[0]);\n            }\n          } catch {\n            headers = Object.keys(surveyData[0]);\n          }\n          // Hide db identifiers from preview\n          headers = headers.filter(h => h.toLowerCase() !== 'id' && h.toLowerCase() !== 'surveyid');\n          const rows = surveyData.map(row => headers.map(header => String(row[header as keyof typeof row] || '')));\n          \n          setStats({\n            columnNames: headers,\n            totalRows: surveyData.length,\n            uniqueSpecialties: new Set(surveyData.map(row => row.specialty)).size,\n            totalDataPoints: surveyData.length * headers.length\n          });\n          setPreviewData([headers, ...rows]);\n        }\n        if (!isCancelled && pagination) {\n          setPagination(pagination);\n        }\n        if (!isCancelled) setIsLoading(false);\n      } catch (error) {\n        console.error('Error loading survey data:', error);\n        onError('Error loading survey data from backend');\n        if (!isCancelled) setIsLoading(false);\n      }\n    };\n\n    if (file.id) {\n      loadSurveyData();\n    }\n    return () => {\n      isCancelled = true;\n    };\n  }, [file.id, currentPage, pageSize]); // Removed globalFilters dependency to prevent flickering\n\n  // Separate effect for filter changes with debouncing\n  useEffect(() => {\n    let isCancelled = false;\n    let timeoutId: NodeJS.Timeout;\n    \n    const loadFilteredData = async () => {\n      try {\n        setIsRefreshing(true);\n        const backendService = BackendService.getInstance();\n        \n        const filters = {\n          specialty: globalFilters.specialty || undefined,\n          providerType: globalFilters.providerType || undefined,\n          region: globalFilters.region || undefined\n        };\n        \n        const { rows: surveyData, pagination } = await backendService.getSurveyData(\n          file.id,\n          filters,\n          { page: 1, limit: pageSize } // Reset to page 1 when filters change\n        );\n        \n        if (!isCancelled && surveyData.length > 0) {\n          setOriginalData(surveyData);\n          \n          // Reuse existing headers if available\n          let headers: string[] = [];\n          if (previewData[0] && previewData[0].length > 0) {\n            headers = previewData[0];\n          } else {\n            try {\n              const meta = await BackendService.getInstance().getSurveyMeta(file.id);\n              if (Array.isArray(meta.columns) && meta.columns.length > 0) {\n                headers = meta.columns;\n              } else {\n                headers = Object.keys(surveyData[0]);\n              }\n            } catch {\n              headers = Object.keys(surveyData[0]);\n            }\n          }\n          \n          headers = headers.filter(h => h.toLowerCase() !== 'id' && h.toLowerCase() !== 'surveyid');\n          const rows = surveyData.map(row => headers.map(header => String(row[header as keyof typeof row] || '')));\n          \n          setStats({\n            columnNames: headers,\n            totalRows: surveyData.length,\n            uniqueSpecialties: new Set(surveyData.map(row => row.specialty)).size,\n            totalDataPoints: surveyData.length * headers.length\n          });\n          setPreviewData([headers, ...rows]);\n          setCurrentPage(1); // Reset to first page\n        }\n        if (!isCancelled && pagination) {\n          setPagination(pagination);\n        }\n        if (!isCancelled) setIsRefreshing(false);\n      } catch (error) {\n        console.error('Error loading filtered data:', error);\n        onError('Error loading filtered data from backend');\n        if (!isCancelled) setIsRefreshing(false);\n      }\n    };\n\n    // Debounce filter changes to prevent rapid API calls\n    timeoutId = setTimeout(() => {\n      if (file.id) {\n        loadFilteredData();\n      }\n    }, 300); // 300ms debounce\n\n    return () => {\n      isCancelled = true;\n      clearTimeout(timeoutId);\n    };\n  }, [globalFilters.specialty, globalFilters.providerType, globalFilters.region, file.id, pageSize]);\n\n  // Load global filter options from server (not paginated)\n  useEffect(() => {\n    let cancelled = false;\n    const loadFilters = async () => {\n      try {\n        const f = await BackendService.getInstance().getAvailableFiltersForSurvey(file.id);\n        if (cancelled) return;\n        setServerSpecialties((f.specialties || []).sort());\n        setServerProviderTypes((f.providerTypes || []).sort());\n        setServerRegions((f.regions || []).sort());\n      } catch {}\n    };\n    if (file.id) loadFilters();\n    return () => { cancelled = true; };\n  }, [file.id]);\n\n  // Cascading filter options based on current selections\n  const cascadingFilterOptions = useMemo(() => {\n    // Use server-side filter options which have access to the full dataset\n    // Only apply cascading logic if we have server options\n    if (!serverSpecialties.length && !serverProviderTypes.length && !serverRegions.length) {\n      return {\n        specialties: [],\n        providerTypes: [],\n        regions: []\n      };\n    }\n\n    // For now, return all server options until we implement proper server-side cascading\n    // The server /filters endpoint already has access to the full dataset\n    return {\n      specialties: serverSpecialties,\n      providerTypes: serverProviderTypes,\n      regions: serverRegions\n    };\n  }, [serverSpecialties, serverProviderTypes, serverRegions]);\n\n  const filteredData = useMemo(() => {\n    if (!originalData.length || !stats) return [];\n\n    // Server is now handling the filtering, so just convert to display format\n    if (originalData.length > 0 && previewData[0]) {\n      const headers = previewData[0];\n      return originalData.map(row => headers.map(header => String(row[header as keyof typeof row] || '')));\n    }\n\n    return [];\n  }, [originalData, stats, previewData]);\n\n  const totalPages = pagination?.pages ?? 1;\n\n  // Formatting helpers\n  const formatCurrency = (value: any, decimals: number) => {\n    const num = typeof value === 'number' ? value : parseFloat(String(value).replace(/[^0-9.-]/g, ''));\n    if (Number.isNaN(num)) return value ?? '';\n    return num.toLocaleString('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: decimals, maximumFractionDigits: decimals });\n  };\n  const formatNumber = (value: any, decimals: number) => {\n    const num = typeof value === 'number' ? value : parseFloat(String(value).replace(/[^0-9.-]/g, ''));\n    if (Number.isNaN(num)) return value ?? '';\n    return num.toLocaleString('en-US', { minimumFractionDigits: decimals, maximumFractionDigits: decimals });\n  };\n\n  const createColumnDefs = () => {\n    // If we have the server-derived headers, use them; otherwise fall back to previewData detection\n    const headers = previewData[0] || [];\n    return headers\n      .filter((header: string) => {\n        const lower = String(header).toLowerCase();\n        return lower !== 'id' && lower !== 'surveyid';\n      })\n      .map((header: string) => {\n      const key = header;\n      const lower = header.toLowerCase();\n      const isTcc = lower.startsWith('tcc_') || lower.includes('total_cash') || lower.includes('tcc');\n      const isCf = lower.startsWith('cf_') || lower.includes('conversion');\n      const isWrvu = lower.includes('wrvu');\n      const isCount = lower === 'n_orgs' || lower === 'n_incumbents';\n      const isNumeric = isTcc || isCf || isWrvu || isCount;\n      const isSpecialty = lower.includes('specialty');\n\n      return {\n        headerName: header,\n        field: key,\n        sortable: true,\n        filter: isNumeric ? 'agNumberColumnFilter' : 'agTextColumnFilter',\n        resizable: true,\n        cellClass: isNumeric ? 'ag-right-aligned-cell' : (isSpecialty ? 'font-semibold' : undefined),\n        headerClass: isNumeric ? 'ag-right-aligned-header' : undefined,\n        headerComponent: 'CustomHeader',\n        headerComponentParams: {\n          onPinColumn: (colId: string) => {\n            if (!columnApi) return;\n            const column = columnApi.getColumn(colId);\n            const isPinned = column?.getColDef().pinned === 'left';\n            columnApi.applyColumnState({\n              state: [{ colId, pinned: isPinned ? null : 'left' }]\n            });\n          },\n          isSpecialty: isSpecialty,\n          isNumeric: isNumeric\n        },\n        valueGetter: (params: any) => {\n          const raw = params.data[key];\n          if (isNumeric) {\n            const num = parseFloat(String(raw).replace(/[^0-9.-]/g, ''));\n            return Number.isNaN(num) ? null : num;\n          }\n          return raw;\n        },\n        valueFormatter: (params: any) => {\n          const raw = params.value ?? params.data?.[key];\n          if (raw === undefined || raw === null) return '';\n          if (isTcc) return formatCurrency(raw, 0);\n          if (isCf) return formatCurrency(raw, 2);\n          if (isWrvu || isCount) return formatNumber(raw, 0);\n          return raw;\n        },\n      } as any;\n    });\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"w-full bg-white shadow-sm\">\n        {/* Keep the filter controls visible during loading */}\n        <Box sx={{ \n          display: 'flex',\n          flexDirection: 'column',\n          p: 2, \n          borderBottom: 1, \n          borderColor: 'divider'\n        }}>\n          {/* Header with Clear Filter Button */}\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">Survey Preview</h3>\n            <button\n              disabled\n              className=\"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-400 cursor-not-allowed\"\n              title=\"Clear all filters\"\n            >\n              <div className=\"relative w-4 h-4 mr-2\">\n                <svg className=\"w-4 h-4 text-gray-300\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path d=\"M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z\" />\n                </svg>\n              </div>\n              <span className=\"text-xs\">Clear Filters</span>\n            </button>\n          </div>\n\n          {/* Filter Dropdowns - Disabled during loading */}\n          <div className=\"grid grid-cols-3 gap-4\">\n            {[...Array(3)].map((_, i) => (\n              <div key={i} className=\"animate-pulse\">\n                <div className=\"h-10 bg-gray-200 rounded-md\"></div>\n              </div>\n            ))}\n          </div>\n        </Box>\n\n        {/* Data Table Loading State */}\n        <div className=\"ag-theme-alpine\" style={{ height: 520, width: '100%' }}>\n          <div className=\"animate-pulse\">\n            <div className=\"h-10 bg-gray-200 mb-2\"></div>\n            {[...Array(10)].map((_, i) => (\n              <div key={i} className=\"h-8 bg-gray-100 mb-1\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"w-full bg-white shadow-sm\">\n      {/* Filter Controls */}\n      <Box sx={{ \n        display: 'flex',\n        flexDirection: 'column',\n        p: 2, \n        borderBottom: 1, \n        borderColor: 'divider'\n      }}>\n        {/* Header with Clear Filter Button */}\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-gray-900\">Survey Preview</h3>\n          <button\n            onClick={() => {\n              onFilterChange('specialty', '');\n              onFilterChange('providerType', '');\n              onFilterChange('region', '');\n              setCurrentPage(1);\n            }}\n            className=\"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-all duration-200\"\n            title=\"Clear all filters\"\n          >\n            <div className=\"relative w-4 h-4 mr-2\">\n              {/* Funnel Icon */}\n              <svg className=\"w-4 h-4 text-gray-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path d=\"M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z\" />\n              </svg>\n              {/* X Overlay - Only show when filters are active */}\n              {(globalFilters.specialty || globalFilters.providerType || globalFilters.region) && (\n                <svg className=\"absolute -top-1 -right-1 w-3 h-3 text-red-500 bg-white rounded-full\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                </svg>\n              )}\n            </div>\n            <span className=\"text-xs\">Clear Filters</span>\n          </button>\n        </div>\n\n        {/* Filter Dropdowns - Perfectly Aligned */}\n        <div className=\"grid grid-cols-3 gap-4\">\n          <FormControl fullWidth size=\"small\">\n            <InputLabel className=\"text-sm font-medium text-gray-700 mb-2\">Specialty</InputLabel>\n            <Select\n              name=\"specialty\"\n              value={globalFilters.specialty}\n              onChange={handleFilterChange}\n              label=\"Specialty\"\n              className=\"h-10\"\n              sx={{\n                '& .MuiOutlinedInput-root': {\n                  borderRadius: '8px',\n                }\n              }}\n            >\n              <MenuItem value=\"\">All</MenuItem>\n              {cascadingFilterOptions.specialties.map(specialty => (\n                <MenuItem key={specialty} value={specialty}>{specialty}</MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n\n          <FormControl fullWidth size=\"small\">\n            <InputLabel className=\"text-sm font-medium text-gray-700 mb-2\">Provider Type</InputLabel>\n            <Select\n              name=\"providerType\"\n              value={globalFilters.providerType}\n              onChange={handleFilterChange}\n              label=\"Provider Type\"\n              className=\"h-10\"\n              sx={{\n                '& .MuiOutlinedInput-root': {\n                  borderRadius: '8px',\n                }\n              }}\n            >\n              <MenuItem value=\"\">All</MenuItem>\n              {cascadingFilterOptions.providerTypes.map(type => (\n                <MenuItem key={type} value={type}>{type}</MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n\n          <FormControl fullWidth size=\"small\">\n            <InputLabel className=\"text-sm font-medium text-gray-700 mb-2\">Geographic Region</InputLabel>\n            <Select\n              name=\"region\"\n              value={globalFilters.region}\n              onChange={handleFilterChange}\n              label=\"Geographic Region\"\n              className=\"h-10\"\n              sx={{\n                '& .MuiOutlinedInput-root': {\n                  borderRadius: '8px',\n                }\n              }}\n            >\n              <MenuItem value=\"\">All</MenuItem>\n              {cascadingFilterOptions.regions.map(region => (\n                <MenuItem key={region} value={region}>{region}</MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n        </div>\n      </Box>\n\n      {/* Data Table - AG Grid as primary */}\n      <div className=\"ag-theme-alpine relative px-4 py-2 rounded-lg border border-gray-200\" style={{ height: 520, width: '100%' }}>\n        {/* Subtle refreshing overlay */}\n        {isRefreshing && (\n          <div className=\"absolute inset-0 bg-white bg-opacity-50 flex items-center justify-center z-10\">\n            <div className=\"flex items-center space-x-2 text-gray-600\">\n              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600\"></div>\n              <span className=\"text-sm\">Updating data...</span>\n            </div>\n          </div>\n        )}\n        <Suspense fallback={<AgGridLoadingSpinner />}>\n          <AgGridWrapper\n            onGridReady={(params: any) => {\n              setGridApi(params.api);\n              setColumnApi(params.columnApi);\n            }}\n            rowData={filteredData.map((row) => {\n              const obj: Record<string, string> = {};\n              (previewData[0] || []).forEach((header, idx) => {\n                obj[header] = row[idx];\n              });\n              return obj;\n            })}\n            columnDefs={createColumnDefs()}\n            defaultColDef={{ sortable: true, filter: true, resizable: true }}\n            suppressRowClickSelection={true}\n            components={{\n              CustomHeader: CustomHeader\n            }}\n            pagination={false}\n            domLayout=\"autoHeight\"\n            suppressRowHoverHighlight={true}\n            rowHeight={40}\n            suppressColumnVirtualisation={false}\n            suppressHorizontalScroll={false}\n          />\n        </Suspense>\n      </div>\n      {/* Modern Server-side pagination controls */}\n      {totalPages > 1 && (\n        <div className=\"flex items-center justify-between px-6 py-4 border-t border-gray-200 bg-white\">\n          {/* Left side - Page info and page size */}\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"text-sm text-gray-600\">\n              Showing page <span className=\"font-medium text-gray-900\">{currentPage}</span> of <span className=\"font-medium text-gray-900\">{totalPages}</span>\n            </div>\n            <div className=\"text-sm text-gray-500\">\n              ({pagination?.total?.toLocaleString() || 0} total records)\n            </div>\n          </div>\n\n          {/* Center - Page navigation */}\n          <div className=\"flex items-center space-x-2\">\n            {/* First page */}\n            <button\n              className=\"inline-flex items-center px-2.5 py-1.5 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-40 disabled:cursor-not-allowed transition-colors duration-200\"\n              onClick={() => setCurrentPage(1)}\n              disabled={currentPage <= 1}\n              title=\"Go to first page\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M15.707 15.707a1 1 0 01-1.414 0l-5-5a1 1 0 010-1.414l5-5a1 1 0 111.414 1.414L11.414 9H17a1 1 0 110 2h-5.586l4.293 4.293a1 1 0 010 1.414z\" clipRule=\"evenodd\" />\n              </svg>\n            </button>\n\n            {/* Previous page */}\n            <button\n              className=\"inline-flex items-center px-2.5 py-1.5 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-40 disabled:cursor-not-allowed transition-colors duration-200\"\n              onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\n              disabled={currentPage <= 1}\n              title=\"Previous page\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n              </svg>\n            </button>\n\n            {/* Page input */}\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-sm text-gray-500\">Page</span>\n              <input\n                type=\"number\"\n                min=\"1\"\n                max={totalPages}\n                value={currentPage}\n                onChange={(e) => {\n                  const value = parseInt(e.target.value);\n                  if (value >= 1 && value <= totalPages) {\n                    setCurrentPage(value);\n                  }\n                }}\n                onKeyPress={(e) => {\n                  if (e.key === 'Enter') {\n                    const value = parseInt(e.currentTarget.value);\n                    if (value >= 1 && value <= totalPages) {\n                      setCurrentPage(value);\n                    }\n                  }\n                }}\n                className=\"w-16 px-2 py-1 text-sm text-center border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"\n                title={`Enter page number (1-${totalPages})`}\n              />\n              <span className=\"text-sm text-gray-500\">of {totalPages}</span>\n            </div>\n\n            {/* Next page */}\n            <button\n              className=\"inline-flex items-center px-2.5 py-1.5 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-40 disabled:cursor-not-allowed transition-colors duration-200\"\n              onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))}\n              disabled={currentPage >= totalPages}\n              title=\"Next page\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clipRule=\"evenodd\" />\n              </svg>\n            </button>\n\n            {/* Last page */}\n            <button\n              className=\"inline-flex items-center px-2.5 py-1.5 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-40 disabled:cursor-not-allowed transition-colors duration-200\"\n              onClick={() => setCurrentPage(totalPages)}\n              disabled={currentPage >= totalPages}\n              title=\"Go to last page\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0l5 5a1 1 0 010 1.414l-5 5a1 1 0 01-1.414-1.414L8.586 11H3a1 1 0 110-2h5.586L4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n              </svg>\n            </button>\n          </div>\n\n          {/* Right side - Quick navigation */}\n          <div className=\"flex items-center space-x-2\">\n            {/* Quick jump buttons */}\n            {currentPage > 5 && (\n              <button\n                className=\"px-2 py-1 text-xs text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors duration-200\"\n                onClick={() => setCurrentPage(1)}\n              >\n                1\n              </button>\n            )}\n            {currentPage > 5 && (\n              <span className=\"text-gray-400\">...</span>\n            )}\n            \n            {/* Page numbers around current page */}\n            {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\n              const pageNum = Math.max(1, Math.min(totalPages - 4, currentPage - 2)) + i;\n              if (pageNum > totalPages) return null;\n              \n              return (\n                <button\n                  key={pageNum}\n                  className={`px-2 py-1 text-xs rounded transition-colors duration-200 ${\n                    pageNum === currentPage\n                      ? 'bg-indigo-600 text-white'\n                      : 'text-gray-500 hover:text-gray-700 hover:bg-gray-100'\n                  }`}\n                  onClick={() => setCurrentPage(pageNum)}\n                >\n                  {pageNum}\n                </button>\n              );\n            })}\n            \n            {currentPage < totalPages - 4 && (\n              <span className=\"text-gray-400\">...</span>\n            )}\n            {currentPage < totalPages - 4 && (\n              <button\n                className=\"px-2 py-1 text-xs text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors duration-200\"\n                onClick={() => setCurrentPage(totalPages)}\n              >\n                {totalPages}\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n      \n    </div>\n  );\n};\n\nexport default DataPreview; ","import React, { useState, useCallback, useEffect, useRef } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { CloudArrowUpIcon, XMarkIcon, CalendarIcon, ChevronDownIcon, ChevronRightIcon } from '@heroicons/react/24/outline';\nimport { FormControl, InputLabel, Select, MenuItem } from '@mui/material';\nimport DataPreview from './DataPreview';\nimport BackendService from '../services/BackendService';\nimport { ISurveyData, ISurveyRow, ISurveyMetadata } from '../types/survey';\nimport { TableFilters } from './TableFilters';\n\nconst SURVEY_OPTIONS = [\n  'SullivanCotter',\n  'MGMA',\n  'Gallagher',\n  'ECG',\n  'AMGA'\n];\n\ninterface FileWithPreview extends File {\n  preview?: string;\n  id?: string;\n  surveyType?: string;\n  surveyYear?: string;\n  uploadDate?: Date;\n}\n\ninterface StorageSurvey {\n  id: string;\n  metadata: ISurveyMetadata & {\n    surveyType: string;\n    fileContent: string;\n  };\n}\n\ninterface UploadedSurveyMetadata {\n  id: string;\n  fileName: string;\n  surveyType: string;\n  surveyYear: string;\n  uploadDate: Date;\n  stats: {\n    totalRows: number;\n    uniqueSpecialties: number;\n    totalDataPoints: number;\n  }\n}\n\ninterface UploadedSurvey extends UploadedSurveyMetadata {\n  fileContent: string;\n  rows: ISurveyRow[];\n}\n\n// Normalization Note:\n// -------------------\n// Many survey CSVs use snake_case headers (e.g., provider_type, geographic_region),\n// but the application expects camelCase (providerType, geographicRegion) for internal logic and dropdowns.\n// To ensure robust mapping regardless of CSV header style, we normalize both required column names and CSV headers to camelCase before mapping.\n// This prevents dropdowns (like Provider Type and Region) from being empty due to mismatched field names.\n// If you add new required columns, ensure they are included in the normalization logic.\n// See mapping logic in handleSurveyUpload for details.\n\nconst SurveyUpload: React.FC = () => {\n  const [files, setFiles] = useState<FileWithPreview[]>([]);\n  const [uploadedSurveys, setUploadedSurveys] = useState<UploadedSurvey[]>([]);\n  const [surveyType, setSurveyType] = useState('');\n  const [customSurveyType, setCustomSurveyType] = useState('');\n  const [surveyYear, setSurveyYear] = useState('');\n  const [isCustom, setIsCustom] = useState(false);\n  const [isYearPickerOpen, setIsYearPickerOpen] = useState(false);\n  const [error, setError] = useState<string>('');\n  const [selectedSurvey, setSelectedSurvey] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [deleteProgress, setDeleteProgress] = useState(0);\n  \n  // Add global filter state\n  const [globalFilters, setGlobalFilters] = useState({\n    specialty: '',\n    providerType: '',\n    region: ''\n  });\n\n  // Add state for unique values across all surveys\n  const [uniqueValues, setUniqueValues] = useState<{\n    specialties: Set<string>;\n    providerTypes: Set<string>;\n    regions: Set<string>;\n  }>({\n    specialties: new Set(),\n    providerTypes: new Set(),\n    regions: new Set()\n  });\n\n  // Add state for collapsible sections\n  const [isUploadSectionCollapsed, setIsUploadSectionCollapsed] = useState(false);\n  const [isUploadedSurveysCollapsed, setIsUploadedSurveysCollapsed] = useState(false);\n\n  // Add ref for year picker click-outside handling\n  const yearPickerRef = useRef<HTMLDivElement>(null);\n\n  const backendService = React.useMemo(() => BackendService.getInstance(), []);\n\n  // Handle click outside year picker\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (yearPickerRef.current && !yearPickerRef.current.contains(event.target as Node)) {\n        setIsYearPickerOpen(false);\n      }\n    };\n\n    if (isYearPickerOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isYearPickerOpen]);\n\n  // Update unique values when surveys change\n  useEffect(() => {\n    const newValues = {\n      specialties: new Set<string>(),\n      providerTypes: new Set<string>(),\n      regions: new Set<string>()\n    };\n\n    uploadedSurveys.forEach(survey => {\n      if (!survey.fileContent) return;  // Skip if no file content\n      \n      const lines = survey.fileContent.split('\\n');\n      const headers = lines[0].split(',').map(h => h.trim().toLowerCase());\n      \n      const specialtyIdx = headers.findIndex(h => h.includes('specialty'));\n      const providerTypeIdx = headers.findIndex(h => h.includes('provider') || h.includes('type'));\n      const regionIdx = headers.findIndex(h => h.includes('region') || h.includes('geography'));\n\n      lines.slice(1).forEach(line => {\n        const values = line.split(',').map(v => v.trim());\n        if (specialtyIdx >= 0) newValues.specialties.add(values[specialtyIdx]);\n        if (providerTypeIdx >= 0) newValues.providerTypes.add(values[providerTypeIdx]);\n        if (regionIdx >= 0) newValues.regions.add(values[regionIdx]);\n      });\n    });\n\n    setUniqueValues(newValues);\n  }, [uploadedSurveys]);\n\n  // Handle global filter changes\n  const handleFilterChange = (filterName: string, value: string) => {\n    setGlobalFilters(prev => ({\n      ...prev,\n      [filterName]: value\n    }));\n  };\n\n  // Load saved surveys on component mount\n  useEffect(() => {\n    const loadSurveys = async () => {\n      try {\n        setIsLoading(true);\n        const surveys = await backendService.getAllSurveys();\n        console.log('Loaded surveys:', surveys);\n        \n        // Build lightweight survey list; fetch detailed rows only when a survey is selected\n        const processedSurveys = surveys.map((survey: any) => ({\n          id: survey.id,\n          fileName: survey.name || '',\n          surveyType: survey.type || '',\n          surveyYear: survey.year?.toString() || '',\n          uploadDate: new Date(survey.uploadDate || new Date()),\n          fileContent: '',\n          rows: [],\n          stats: {\n            totalRows: survey.rowCount ?? survey.row_count ?? 0,\n            uniqueSpecialties: survey.specialtyCount ?? survey.specialty_count ?? 0,\n            totalDataPoints: survey.dataPoints ?? survey.data_points ?? 0\n          },\n          columnMappings: {}\n        }));\n\n        setUploadedSurveys(processedSurveys);\n        // Auto-select first survey if none selected\n        if (!selectedSurvey && processedSurveys.length > 0) {\n          setSelectedSurvey(processedSurveys[0].id);\n        }\n      } catch (error) {\n        console.error('Error loading surveys:', error);\n        handleError('Error loading saved surveys');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadSurveys();\n  }, [backendService]);\n\n  const onDrop = useCallback((acceptedFiles: File[]) => {\n    const newFiles = acceptedFiles.map(file => Object.assign(file, {\n      preview: URL.createObjectURL(file),\n      id: Math.random().toString(36).substring(7)\n    }));\n    setFiles(prev => [...prev, ...newFiles]);\n  }, []);\n\n  const { getRootProps, getInputProps } = useDropzone({\n    onDrop,\n    accept: {\n      'text/csv': ['.csv']\n    },\n    multiple: false,\n    maxFiles: 1\n  });\n\n  const removeFile = (fileId: string) => {\n    setFiles(prev => {\n      const fileToRemove = prev.find(f => f.id === fileId);\n      if (fileToRemove?.preview) {\n        URL.revokeObjectURL(fileToRemove.preview);\n      }\n      return [];  // Clear all files since we only handle one at a time\n    });\n    setSelectedSurvey(null);\n  };\n\n  const handleSurveyTypeChange = (e: React.ChangeEvent<{ value: unknown }>) => {\n    const value = e.target.value as string;\n    setIsCustom(value === 'custom');\n    setSurveyType(value);\n    // Clear any selected file when survey type changes\n    setFiles([]);\n  };\n\n  const removeUploadedSurvey = async (surveyId: string, e?: React.MouseEvent) => {\n    e?.stopPropagation();\n    try {\n      await backendService.deleteSurvey(surveyId);\n      setUploadedSurveys(prev => prev.filter(s => s.id !== surveyId));\n      if (selectedSurvey === surveyId) {\n        setSelectedSurvey(null);\n      }\n    } catch (error) {\n      console.error('Error removing survey:', error);\n      handleError('Error removing survey');\n    }\n  };\n\n  const handleSurveyUpload = async () => {\n    const file = files[0];\n    if (!file || !surveyType || !surveyYear) {\n      handleError('Please fill in all required fields');\n      return;\n    }\n\n    setIsUploading(true);\n    setUploadProgress(0);\n\n    try {\n      // Simulate progress for better UX\n      // Real upload progress from XHR (front-end only). Once the file is uploaded,\n      // the modal stays with an indeterminate spinner while the server processes rows.\n\n      // Upload survey to backend\n      const uploadResult = await backendService.uploadSurvey(\n        file,\n        file.name,\n        parseInt(surveyYear),\n        isCustom ? customSurveyType : surveyType,\n        (p) => setUploadProgress(Math.min(p, 100))\n      );\n      // At this point the file is on the server; server-side parsing/inserts may still be running.\n      setUploadProgress(100);\n\n      console.log('Survey uploaded successfully:', {\n        surveyId: uploadResult.surveyId,\n        rowCount: uploadResult.rowCount\n      });\n\n      // Update local state and select the new survey\n      setUploadedSurveys(prev => {\n        const updated = [\n          ...prev,\n          {\n            id: uploadResult.surveyId,\n            fileName: file.name,\n            surveyType: isCustom ? customSurveyType : surveyType,\n            surveyYear,\n            uploadDate: new Date(),\n            fileContent: '',\n            rows: [],\n            stats: {\n              totalRows: uploadResult.rowCount,\n              uniqueSpecialties: 0,\n              totalDataPoints: uploadResult.rowCount\n            },\n            columnMappings: {}\n          }\n        ];\n        return updated;\n      });\n      \n      setSelectedSurvey(uploadResult.surveyId);\n\n      // Clear form\n      setFiles([]);\n      setSurveyType('');\n      setSurveyYear('');\n      setCustomSurveyType('');\n      setIsCustom(false);\n\n      // Show success message\n      setTimeout(() => {\n        setUploadProgress(0);\n        setIsUploading(false);\n      }, 1000);\n\n    } catch (error) {\n      console.error('Error uploading survey:', error);\n      handleError(`Upload failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n      setIsUploading(false);\n      setUploadProgress(0);\n    }\n  };\n\n  const handleClearAll = async () => {\n    try {\n      // Confirm destructive action\n      const confirmDelete = window.confirm('This will delete ALL surveys from Azure. Type OK to proceed.');\n      if (!confirmDelete) return;\n      setIsDeleting(true);\n      setDeleteProgress(10);\n      await backendService.deleteAllSurveys();\n      setDeleteProgress(90);\n      setUploadedSurveys([]);\n      setSelectedSurvey(null);\n    } catch (error) {\n      console.error('Error clearing all surveys:', error);\n      handleError('Error clearing surveys');\n    } finally {\n      setDeleteProgress(100);\n      setTimeout(() => {\n        setIsDeleting(false);\n        setDeleteProgress(0);\n      }, 600);\n    }\n  };\n\n  // Generate years from 1990 to current year + 10 (more future-proof)\n  const currentYear = new Date().getFullYear();\n  const startYear = 1990;\n  const endYear = currentYear + 10; // Extend to 10 years in the future\n  const years = Array.from(\n    { length: endYear - startYear + 1 },\n    (_, i) => endYear - i\n  );\n\n  const handleError = (errorMessage: string) => {\n    setError(errorMessage);\n    setTimeout(() => setError(''), 5000);\n  };\n\n  // Add helper function to calculate survey statistics\n  const calculateSurveyStats = (rows: ISurveyRow[] | undefined) => {\n    if (!rows || rows.length === 0) {\n      return {\n        totalRows: 0,\n        uniqueSpecialties: 0,\n        totalDataPoints: 0\n      };\n    }\n    // Only call toLowerCase on string values\n    const uniqueSpecialtiesSet = new Set(\n      rows\n        .map(r => typeof r.specialty === 'string' ? r.specialty.toLowerCase() : undefined)\n        .filter(Boolean)\n    );\n    return {\n      totalRows: rows.length,\n      uniqueSpecialties: uniqueSpecialtiesSet.size,\n      totalDataPoints: rows.length * Object.keys(rows[0] || {}).length\n    };\n  };\n\n  return (\n    <>\n      <div className=\"w-full min-h-screen\">\n        <div className=\"w-full flex flex-col gap-4\">\n\n          {/* Upload Form Section */}\n          <div className=\"w-full bg-white rounded-xl shadow-sm border border-gray-200 p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"flex items-center gap-2\">\n                <button\n                  onClick={() => setIsUploadSectionCollapsed(!isUploadSectionCollapsed)}\n                  className=\"p-1 hover:bg-gray-100 rounded-lg transition-colors duration-200\"\n                  aria-label={isUploadSectionCollapsed ? \"Expand upload section\" : \"Collapse upload section\"}\n                >\n                  {isUploadSectionCollapsed ? (\n                    <ChevronRightIcon className=\"h-5 w-5 text-gray-500\" />\n                  ) : (\n                    <ChevronDownIcon className=\"h-5 w-5 text-gray-500\" />\n                  )}\n                </button>\n                <h3 className=\"text-lg font-semibold text-gray-900\">Upload New Survey</h3>\n              </div>\n              <a\n                href={process.env.PUBLIC_URL + '/sample-survey.csv'}\n                download=\"sample-survey.csv\"\n                className=\"inline-flex items-center px-3 py-1.5 text-xs font-medium rounded-md text-indigo-600 bg-indigo-50 hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200\"\n              >\n                Download Sample\n              </a>\n            </div>\n            \n            {!isUploadSectionCollapsed && (\n              <>\n                <div className=\"grid grid-cols-12 gap-4\">\n                {/* Survey Type Selection */}\n                <div className=\"col-span-4\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Survey Type\n                  </label>\n                  <FormControl fullWidth>\n                    <Select\n                      value={surveyType}\n                      onChange={handleSurveyTypeChange}\n                      displayEmpty\n                      sx={{\n                        backgroundColor: 'white',\n                        height: '40px',\n                        '& .MuiOutlinedInput-root': {\n                          fontSize: '0.875rem',\n                          height: '40px',\n                          borderRadius: '8px',\n                        },\n                        '& .MuiSelect-select': {\n                          paddingTop: '8px',\n                          paddingBottom: '8px',\n                          textAlign: 'left',\n                        }\n                      }}\n                    >\n                      <MenuItem value=\"\" disabled>\n                        Select a survey type\n                      </MenuItem>\n                      {SURVEY_OPTIONS.map(option => (\n                        <MenuItem key={option} value={option}>{option}</MenuItem>\n                      ))}\n                      <MenuItem value=\"custom\">Custom Survey Type</MenuItem>\n                    </Select>\n                  </FormControl>\n                  {isCustom && (\n                    <input\n                      type=\"text\"\n                      value={customSurveyType}\n                      onChange={(e: React.ChangeEvent<HTMLInputElement>) => setCustomSurveyType(e.target.value)}\n                      placeholder=\"Enter custom survey type\"\n                      className=\"mt-2 block w-full px-3 py-2 border border-gray-300 rounded-lg\n                        focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent\n                        placeholder-gray-400 text-sm transition-colors duration-200\"\n                    />\n                  )}\n                </div>\n\n                {/* Survey Year Selection */}\n                <div className=\"col-span-4\">\n                  <label htmlFor=\"surveyYear\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Survey Year\n                  </label>\n                  <div className=\"relative\">\n                    <input\n                      type=\"text\"\n                      id=\"surveyYear\"\n                      value={surveyYear}\n                      onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                        const value = e.target.value;\n                        // Allow typing numbers and basic validation\n                        if (value === '' || /^\\d{4}$/.test(value)) {\n                          setSurveyYear(value);\n                        }\n                      }}\n                      onClick={() => setIsYearPickerOpen(true)}\n                      onFocus={() => setIsYearPickerOpen(true)}\n                      placeholder=\"Select year\"\n                      className=\"block w-full px-3 py-2 border border-gray-300 rounded-lg\n                        focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent\n                        bg-white text-sm transition-colors duration-200\"\n                    />\n                    <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-500\">\n                      <CalendarIcon className=\"h-5 w-5\" />\n                    </div>\n\n                    {/* Simple Year Picker Dropdown */}\n                    {isYearPickerOpen && (\n                      <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60\" ref={yearPickerRef}>\n                        <div className=\"overflow-y-auto max-h-56\">\n                          {years.map(year => (\n                            <button\n                              key={year}\n                              onClick={() => {\n                                setSurveyYear(year.toString());\n                                setIsYearPickerOpen(false);\n                              }}\n                              className={`w-full text-left px-3 py-2 text-sm transition-colors duration-200 hover:bg-gray-50\n                                ${surveyYear === year.toString() \n                                  ? 'bg-indigo-50 text-indigo-600 font-medium' \n                                  : 'text-gray-700'\n                                }`}\n                              onKeyDown={(e) => {\n                                if (e.key === 'Escape') {\n                                  setIsYearPickerOpen(false);\n                                }\n                              }}\n                            >\n                              {year}\n                            </button>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Action Buttons */}\n                <div className=\"col-span-4 flex items-end space-x-3\">\n                  <div {...getRootProps()} className=\"flex-1\">\n                    <input {...getInputProps()} />\n                    <button\n                      type=\"button\"\n                      className=\"w-full px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200 flex items-center justify-center h-10\"\n                    >\n                      <CloudArrowUpIcon className=\"h-5 w-5 mr-2\" />\n                      Select File\n                    </button>\n                  </div>\n                  <button\n                    type=\"button\"\n                    onClick={handleSurveyUpload}\n                    disabled={files.length === 0 || !surveyType || !surveyYear || isUploading}\n                    className=\"flex-1 px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center h-10\"\n                  >\n                    {isUploading ? (\n                      <>\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                        Uploading...\n                      </>\n                    ) : (\n                      'Upload Survey'\n                    )}\n                  </button>\n                </div>\n\n                {/* Upload progress is displayed in a modal overlay below */}\n              </div>\n\n              {/* Selected File Preview */}\n              {files.length > 0 && (\n                <div className=\"mt-6 border-t border-gray-200 pt-4\">\n                  <h3 className=\"text-sm font-medium text-gray-700 mb-3\">Selected File</h3>\n                  <div className=\"bg-gray-50 px-3 py-2 rounded-lg flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-4\">\n                      <div className=\"flex items-center text-gray-500\">\n                        <svg className=\"h-5 w-5 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                        </svg>\n                        <span className=\"text-sm font-medium\">{files[0].name}</span>\n                      </div>\n                      {surveyType && surveyYear && (\n                        <span className=\"text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full\">\n                          {isCustom ? customSurveyType : surveyType}  {surveyYear}\n                        </span>\n                      )}\n                    </div>\n                    <button\n                      onClick={() => files[0].id && removeFile(files[0].id)}\n                      className=\"text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 rounded-full hover:bg-gray-100\"\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                </div>\n              )}\n            </>\n            )}\n          </div>\n          {/* Uploaded Surveys Section (compact tabs) */}\n          <div className=\"w-full bg-white rounded-xl shadow-sm border border-gray-200 p-4 overflow-visible\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <div className=\"flex items-center gap-2\">\n                <button\n                  onClick={() => setIsUploadedSurveysCollapsed(!isUploadedSurveysCollapsed)}\n                  className=\"p-1 hover:bg-gray-100 rounded-lg transition-colors duration-200\"\n                  aria-label={isUploadedSurveysCollapsed ? \"Expand uploaded surveys section\" : \"Collapse uploaded surveys section\"}\n                >\n                  {isUploadedSurveysCollapsed ? (\n                    <ChevronRightIcon className=\"h-5 w-5 text-gray-500\" />\n                  ) : (\n                    <ChevronDownIcon className=\"h-5 w-5 text-gray-500\" />\n                  )}\n                </button>\n                <h2 className=\"text-lg font-semibold text-gray-900\">Uploaded Surveys</h2>\n              </div>\n              {uploadedSurveys.length > 0 && (\n                <button\n                  onClick={handleClearAll}\n                  className=\"inline-flex items-center px-3 py-1.5 text-xs font-medium text-red-600 hover:text-red-700 transition-colors duration-200 rounded-lg hover:bg-red-50\"\n                >\n                  <XMarkIcon className=\"h-4 w-4 mr-1.5\" />\n                  Clear All\n                </button>\n              )}\n            </div>\n\n            {!isUploadedSurveysCollapsed && (\n              <>\n                {isLoading ? (\n                  <div className=\"text-center py-6\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500 mx-auto\"></div>\n                    <p className=\"mt-2 text-sm text-gray-500\">Loading surveys...</p>\n                  </div>\n                ) : uploadedSurveys.length === 0 ? (\n                  <div className=\"text-center py-8 bg-gray-50 rounded-xl\">\n                    <p className=\"text-gray-500\">No surveys uploaded yet</p>\n                  </div>\n                ) : (\n                  <div className=\"relative z-10 flex items-center gap-2 overflow-x-auto overflow-y-visible whitespace-nowrap pb-1\">\n                    {uploadedSurveys.map((survey) => {\n                      const isActive = selectedSurvey === survey.id;\n                      const stats = calculateSurveyStats(survey.rows);\n                      const accent = survey.surveyType === 'SullivanCotter' ? '#818CF8' :\n                                      survey.surveyType === 'MGMA' ? '#34D399' :\n                                      survey.surveyType === 'Gallagher' ? '#F472B6' :\n                                      survey.surveyType === 'ECG' ? '#FBBF24' :\n                                      survey.surveyType === 'AMGA' ? '#60A5FA' : '#9CA3AF';\n                      return (\n                        <div key={survey.id} className=\"relative group inline-flex items-center\">\n                          <button\n                            onClick={() => setSelectedSurvey(survey.id)}\n                            className={`inline-flex items-center gap-2 px-3 py-1.5 text-sm rounded-full border transition-colors duration-200 ${isActive ? 'bg-indigo-600 text-white border-indigo-600' : 'bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100'}`}\n                            title={`${survey.surveyType}  ${survey.surveyYear}`}\n                          >\n                            <span className=\"font-medium\">{survey.surveyType}</span>\n                            <span className={`text-xs ${isActive ? 'text-indigo-100' : 'text-gray-500'}`}>{survey.surveyYear}</span>\n                          </button>\n                          <button\n                            onClick={(e) => removeUploadedSurvey(survey.id, e)}\n                            className=\"ml-1 text-gray-400 hover:text-red-500 p-1 rounded-full hover:bg-gray-100\"\n                            title=\"Remove survey\"\n                          >\n                            <XMarkIcon className=\"h-4 w-4\" />\n                          </button>\n\n                          {/* Hover stats tooltip */}\n                          <div className=\"pointer-events-none absolute z-50 -top-32 left-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-200\">\n                            <div className=\"bg-white rounded-xl shadow-lg border border-gray-200 p-3 w-64\">\n                              <div className=\"flex items-center justify-between mb-2\">\n                                <div className=\"text-xs font-medium text-gray-900\">{survey.surveyType}  {survey.surveyYear}</div>\n                                <div className=\"text-[10px] text-gray-500\">{new Date(survey.uploadDate).toLocaleDateString()}</div>\n                              </div>\n                              <div className=\"grid grid-cols-3 gap-3 text-center\">\n                                <div>\n                                  <div className=\"text-base font-semibold text-gray-900\">{stats.totalRows.toLocaleString()}</div>\n                                  <div className=\"text-[10px] text-gray-500 mt-0.5\">Rows</div>\n                                </div>\n                                <div>\n                                  <div className=\"text-base font-semibold text-gray-900\">{stats.uniqueSpecialties.toLocaleString()}</div>\n                                  <div className=\"text-[10px] text-gray-500 mt-0.5\">Specialties</div>\n                                </div>\n                                <div>\n                                  <div className=\"text-base font-semibold text-gray-900\">{stats.totalDataPoints.toLocaleString()}</div>\n                                  <div className=\"text-[10px] text-gray-500 mt-0.5\">Data Points</div>\n                                </div>\n                              </div>\n                              <div className=\"mt-2 h-1.5 rounded-full\" style={{ backgroundColor: accent }} />\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n\n        {/* Data Preview */}\n        {selectedSurvey && (\n          <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden\">\n            <div className=\"w-full overflow-x-auto\">\n              <DataPreview\n                file={uploadedSurveys.find(s => s.id === selectedSurvey)!}\n                onError={handleError}\n                globalFilters={globalFilters}\n                onFilterChange={handleFilterChange}\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n      {/* Upload Progress Modal */}\n      {isUploading && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"upload-modal-title\">\n          <div className=\"bg-white rounded-xl shadow-lg border border-gray-200 w-full max-w-md p-6\">\n            <div className=\"flex items-start justify-between\">\n              <div>\n                <h3 id=\"upload-modal-title\" className=\"text-lg font-semibold text-gray-900\">Uploading survey</h3>\n                <p className=\"mt-1 text-sm text-gray-500\">Please keep this tab open while we process your file.</p>\n              </div>\n              <div className=\"w-6 h-6 rounded-full border-2 border-indigo-200 border-t-indigo-600 animate-spin\" aria-hidden=\"true\" />\n            </div>\n            <div className=\"mt-5\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-sm font-medium text-gray-700\">Progress</span>\n                <span className=\"text-sm text-gray-500\">{uploadProgress}%</span>\n              </div>\n              <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\n                <div className=\"h-2.5 rounded-full transition-all duration-300 ease-out bg-emerald-600\" style={{ width: `${uploadProgress}%` }} />\n              </div>\n              <div className=\"mt-3 text-xs text-gray-500\">\n                {uploadProgress < 100 ? 'Processing survey data' : 'Upload complete! Finalizing'}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n      {/* Deleting Progress Modal */}\n      {isDeleting && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"delete-modal-title\">\n          <div className=\"bg-white rounded-xl shadow-lg border border-gray-200 w-full max-w-md p-6\">\n            <div className=\"flex items-start justify-between\">\n              <div>\n                <h3 id=\"delete-modal-title\" className=\"text-lg font-semibold text-gray-900\">Clearing surveys</h3>\n                <p className=\"mt-1 text-sm text-gray-500\">Deleting all surveys from Azure. This can take a few seconds.</p>\n              </div>\n              <div className=\"w-6 h-6 rounded-full border-2 border-indigo-200 border-t-indigo-600 animate-spin\" aria-hidden=\"true\" />\n            </div>\n            <div className=\"mt-5\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-sm font-medium text-gray-700\">Progress</span>\n                <span className=\"text-sm text-gray-500\">{deleteProgress}%</span>\n              </div>\n              <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\n                <div className=\"h-2.5 rounded-full transition-all duration-300 ease-out bg-red-600\" style={{ width: `${deleteProgress}%` }} />\n              </div>\n              <div className=\"mt-3 text-xs text-gray-500\">\n                {deleteProgress < 100 ? 'Removing survey data' : 'All surveys cleared.'}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default SurveyUpload; "],"names":["API_BASE_URL","BackendService","constructor","getInstance","instance","getSurveyMeta","surveyId","response","fetch","concat","ok","Error","json","uploadSurvey","file","surveyName","surveyYear","surveyType","onProgress","formData","FormData","append","toString","xhr","XMLHttpRequest","Promise","resolve","reject","open","onload","status","result","JSON","parse","responseText","rowCount","err","statusText","onerror","upload","onprogress","event","lengthComputable","percent","Math","round","loaded","total","send","getAllSurveys","map","survey","_ref","_survey$rowCount","_ref2","_survey$specialtyCoun","_ref3","_survey$dataPoints","id","name","year","type","uploadDate","row_count","specialtyCount","specialty_count","dataPoints","data_points","colorAccent","metadata","getSurveyData","filters","options","params","URLSearchParams","specialty","providerType","region","page","String","limit","data","rows","row","_objectSpread","pagination","Number","length","pages","undefined","getAvailableFiltersForSurvey","deleteSurvey","method","deleteAllSurveys","exportSurveyData","format","arguments","blob","healthCheck","_unused","AgGridWrapper","lazy","AgGridLoadingSpinner","_jsxs","className","children","_jsx","CustomHeader","props","displayName","onPinColumn","colId","isSpecialty","isNumeric","isPinned","setIsPinned","useState","onClick","handlePinClick","title","fill","viewBox","fillRule","d","clipRule","_pagination$pages","_pagination$total","onError","globalFilters","onFilterChange","previewData","setPreviewData","originalData","setOriginalData","stats","setStats","currentPage","setCurrentPage","pageSize","setPagination","isLoading","setIsLoading","isRefreshing","setIsRefreshing","gridApi","setGridApi","columnApi","setColumnApi","pinColumnId","setPinColumnId","useMemo","serverSpecialties","setServerSpecialties","serverProviderTypes","setServerProviderTypes","serverRegions","setServerRegions","handleFilterChange","target","value","useEffect","isCancelled","async","backendService","surveyData","headers","meta","Array","isArray","columns","Object","keys","filter","h","toLowerCase","header","columnNames","totalRows","uniqueSpecialties","Set","size","totalDataPoints","error","console","loadSurveyData","timeoutId","setTimeout","_unused2","loadFilteredData","clearTimeout","cancelled","f","specialties","sort","providerTypes","regions","_unused3","loadFilters","cascadingFilterOptions","filteredData","totalPages","formatCurrency","decimals","num","parseFloat","replace","isNaN","toLocaleString","style","currency","minimumFractionDigits","maximumFractionDigits","Box","sx","display","flexDirection","p","borderBottom","borderColor","disabled","_","i","height","width","FormControl","fullWidth","InputLabel","Select","onChange","label","borderRadius","MenuItem","Suspense","fallback","onGridReady","api","rowData","obj","forEach","idx","columnDefs","lower","key","isTcc","startsWith","includes","isCf","isWrvu","isCount","headerName","field","sortable","resizable","cellClass","headerClass","headerComponent","headerComponentParams","column","getColumn","getColDef","pinned","applyColumnState","state","valueGetter","raw","valueFormatter","_params$value","_params$data","formatNumber","defaultColDef","suppressRowClickSelection","components","domLayout","suppressRowHoverHighlight","rowHeight","suppressColumnVirtualisation","suppressHorizontalScroll","max","min","e","parseInt","onKeyPress","currentTarget","from","pageNum","SURVEY_OPTIONS","SurveyUpload","files","setFiles","uploadedSurveys","setUploadedSurveys","setSurveyType","customSurveyType","setCustomSurveyType","setSurveyYear","isCustom","setIsCustom","isYearPickerOpen","setIsYearPickerOpen","setError","selectedSurvey","setSelectedSurvey","isUploading","setIsUploading","uploadProgress","setUploadProgress","isDeleting","setIsDeleting","deleteProgress","setDeleteProgress","setGlobalFilters","uniqueValues","setUniqueValues","isUploadSectionCollapsed","setIsUploadSectionCollapsed","isUploadedSurveysCollapsed","setIsUploadedSurveysCollapsed","yearPickerRef","useRef","React","handleClickOutside","current","contains","document","addEventListener","removeEventListener","newValues","fileContent","lines","split","trim","specialtyIdx","findIndex","providerTypeIdx","regionIdx","slice","line","values","v","add","surveys","log","processedSurveys","_survey$year","fileName","Date","columnMappings","handleError","loadSurveys","onDrop","useCallback","acceptedFiles","newFiles","assign","preview","URL","createObjectURL","random","substring","prev","getRootProps","getInputProps","useDropzone","accept","multiple","maxFiles","endYear","getFullYear","years","errorMessage","_Fragment","ChevronRightIcon","ChevronDownIcon","href","process","download","displayEmpty","backgroundColor","fontSize","paddingTop","paddingBottom","textAlign","option","placeholder","htmlFor","test","onFocus","CalendarIcon","ref","onKeyDown","CloudArrowUpIcon","uploadResult","message","stroke","strokeLinecap","strokeLinejoin","strokeWidth","fileId","fileToRemove","find","revokeObjectURL","XMarkIcon","window","confirm","isActive","uniqueSpecialtiesSet","r","Boolean","calculateSurveyStats","accent","stopPropagation","s","removeUploadedSurvey","toLocaleDateString","DataPreview","filterName","role"],"sourceRoot":""}